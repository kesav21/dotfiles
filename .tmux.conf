# vim: set foldmethod=marker:

# settings {{{

set -g prefix M-Space

set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

set -g base-index 1

set -g @continuum-restore 'on'

set -g mouse on

# }}}

# keybindings {{{

unbind -a

# keybindings/common {{{

bind -n				C-r			source-file ~/.tmux.conf; display-message "Sourced .tmux.conf!"

# in dwm.tmux		C-n			new pane
# in dwm.tmux		C-x			close pane
# in dwm.tmux		C-j			next pane
# in dwm.tmux		C-k			previous pane
# in dwm.tmux		C-Space		zoom pane

bind -n				C-b			break-pane

bind -r 			h			resize-pane -L 5
bind -r 			j			resize-pane -D 5
bind -r 			k			resize-pane -U 5
bind -r 			l			resize-pane -R 5

bind -n				C-w			new-window

bind -n				C-o			select-window -t :-1
bind -n				C-p			select-window -t :+1

bind -n				C-f			command-prompt -I "#W" "rename-window '%%'"
bind -n				C-g			command-prompt -I "#S" "rename-session '%%'"

bind -n				C-s			choose-tree -s
bind -n				C-q			detach-client

# }}}

# keybindings/dwm {{{

# courtesy of https://github.com/saysjonathan/dwm.tmux

# new pane (in current directory)
bind -n				C-n			split-window -t :.0 -c "#{pane_current_path}" \;\
								swap-pane -s :.0 -t :.1 \;\
								select-layout main-vertical \;\
								run "tmux resize-pane -t :.0 -x \"$(echo \"#{window_width}/2/1\" | bc)\""
# kill pane
bind -n				C-x			kill-pane -t :. \;\
								select-layout main-vertical \;\
								run "tmux resize-pane -t :.0 -x \"$(echo \"#{window_width}/2/1\" | bc)\"" \;\
								select-pane -t :.0

# previous/next pane
bind -n				C-k			select-pane -t :.-
bind -n				C-j			select-pane -t :.+

# zoom pane
bind -n				C-Space		swap-pane -s :. -t :.0 \; select-pane -t :.0

# }}}

# keybindings/misc {{{

bind				M-Space		send-prefix
bind				:			command-prompt

# bind				?			list-keys
# bind				t			clock-mode
# bind				q			display-panes
# bind				R			source-file ~/.tmux.conf; display-message "Sourced .tmux.conf!"

# }}}

# keybindings/panes {{{

# bind				Enter		split-window -h
# bind				x			kill-pane
# bind				!			break-pane

# bind				h			select-pane -L
# bind				j			select-pane -D
# bind				k			select-pane -U
# bind				l			select-pane -R

# bind				{			swap-pane -U
# bind				}			swap-pane -D

# bind -r 			y			resize-pane -L 5
# bind -r 			u			resize-pane -D 5
# bind -r 			i			resize-pane -U 5
# bind -r 			o			resize-pane -R 5

# }}}

# keybindings/windows {{{

# bind				n			new-window
# bind				&			kill-window
# bind				,			command-prompt -I "#W" "rename-window '%%'"

# bind				0			select-window -t :=0
# bind				1			select-window -t :=1
# bind				2			select-window -t :=2
# bind				3			select-window -t :=3
# bind				4			select-window -t :=4
# bind				5			select-window -t :=5
# bind				6			select-window -t :=6
# bind				7			select-window -t :=7
# bind				8			select-window -t :=8
# bind				9			select-window -t :=9

# }}}

# keybindings/sessions {{{

# investigate why using $ throws an error
# bind				$			command-prompt -I "#S" "rename-session '%%'"
# bind				%			command-prompt -I "#S" "rename-session '%%'"

# bind				z			suspend-client
# bind				r			refresh-client
# bind				d			detach-client

# bind				s			choose-tree -s

# }}}

# keybindings/plugins {{{

bind				I			run-shell /home/kesav/.tmux/plugins/tpm/bindings/install_plugins
bind				U			run-shell /home/kesav/.tmux/plugins/tpm/bindings/update_plugins
bind				C			run-shell /home/kesav/.tmux/plugins/tpm/bindings/clean_plugins

# }}}

# keybindings/copy-mode {{{

bind				[			copy-mode
bind				P			paste-buffer

bind -T copy-mode-vi v			send-keys -X begin-selection
bind -T copy-mode-vi y			send-keys -X copy-selection
bind -T copy-mode-vi r			send-keys -X rectangle-toggle

# }}}

# keybindings/scrollback {{{

bind -T root WheelUpPane   if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
bind -T root WheelDownPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; send-keys -M"

# }}}

# }}}

# tpm {{{

# tpm/plugins {{{

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# tpm/plugins/colorscheme {{{

# set -g @plugin 'arcticicestudio/nord-tmux'
# set -g @plugin 'odedlaz/tmux-onedark-theme'
set -g @plugin 'egel/tmux-gruvbox'

# }}}

# }}}

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'

# }}}

